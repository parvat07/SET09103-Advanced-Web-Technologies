{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<h2>Dashboard</h2>
<div class="welcome-message">
    <p>Welcome, {{ current_user.email }}!</p>
</div>

<div class="search-bar">
    <input type="text" id="search" placeholder="Search tasks...">
</div>

<div class="task-actions">
    <a href="{{ url_for('create_task') }}" class="btn btn-primary">Create New Task</a>
</div>

<div class="task-list">
    <!-- High Priority Tasks -->
    <h3>High Priority Tasks</h3>
    <ul>
        {% for task in high_priority_tasks %}
        <li>
            <p><strong>{{ task.title }}</strong> -- 
                {% if task.description %}
                    {% if task.description|length > 10 %}
                        {{ task.description[:10] }}... <a href="{{ url_for('task_detail', task_id=task.id) }}">See more</a>
                    {% else %}
                        {{ task.description }}
                    {% endif %}
                {% else %}
                    No description available
                {% endif %}
                -- Due: {{ task.due_date }}</p>
            <div class="task-buttons">
                <a href="{{ url_for('edit_task', task_id=task.id) }}" class="btn btn-secondary">Edit</a>

                <!-- Delete Form -->
                <form action="{{ url_for('delete_task', task_id=task.id) }}" method="POST" style="display:inline;">
                    <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this task?')">Delete</button>
                </form>
            </div>
        </li>
        {% endfor %}
    </ul>

    <!-- Medium Priority Tasks -->
    <h3>Medium Priority Tasks</h3>
    <ul>
        {% for task in medium_priority_tasks %}
        <li>
            <p><strong>{{ task.title }}</strong> -- 
                {% if task.description %}
                    {% if task.description|length > 10 %}
                        {{ task.description[:10] }}... <a href="{{ url_for('task_detail', task_id=task.id) }}">See more</a>
                    {% else %}
                        {{ task.description }}
                    {% endif %}
                {% else %}
                    No description available
                {% endif %}
                -- Due: {{ task.due_date }}</p>
            <div class="task-buttons">
                <a href="{{ url_for('edit_task', task_id=task.id) }}" class="btn btn-secondary">Edit</a>

                <!-- Delete Form -->
                <form action="{{ url_for('delete_task', task_id=task.id) }}" method="POST" style="display:inline;">
                    <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this task?')">Delete</button>
                </form>
            </div>
        </li>
        {% endfor %}
    </ul>

    <!-- Low Priority Tasks -->
    <h3>Low Priority Tasks</h3>
    <ul>
        {% for task in low_priority_tasks %}
        <li>
            <p><strong>{{ task.title }}</strong> -- 
                {% if task.description %}
                    {% if task.description|length > 10 %}
                        {{ task.description[:10] }}... <a href="{{ url_for('task_detail', task_id=task.id) }}">See more</a>
                    {% else %}
                        {{ task.description }}
                    {% endif %}
                {% else %}
                    No description available
                {% endif %}
                -- Due: {{ task.due_date }}</p>
            <div class="task-buttons">
                <a href="{{ url_for('edit_task', task_id=task.id) }}" class="btn btn-secondary">Edit</a>
                
                <form action="{{ url_for('delete_task', task_id=task.id) }}" method="POST" style="display:inline;">
                    <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this task?')">Delete</button>
                </form>              
            </div>
            
        </li>
        {% endfor %}
    </ul>
</div>

{% endblock %}
